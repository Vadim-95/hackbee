{% block title %}<title>Home</title> {% endblock %}
{% block css %} 
{% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'hackbee/css/bootstrap.css' %}" >  
    <script src="{% static 'hackbee/js/bootstrap.js' %}"></script>  
{% endblock %}
{% block navigation %}
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container justify-content-center">
                <a class="navbar-brand" href="#">HackBee</a>
                <ul class="navbar-nav">
                    <li class="nav-item active">
                    <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link" href="#">Reports</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Help</a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link" href="#">About</a>
                    </li>
                </ul>
            </div>
    </nav>
{% endblock %}
{% block content %}
    <div class="container pt-4">
        <h1>Welcome to Hackbee</h1>
        <p>
            This is a simple web application to demonstrate the use of the Killerbee framework.
        </p>
        <p> The Killerbee framework is a security research framework for the ZigBee protocol. </p>
    </div>
    <div class="container pt-4">
        <h1>Available Devices</h1> 
        <table class="table table-sm">
            <thead>
                <tr>
                    <th>Device ID</th>
                    <th>Product Name</th>
                    <th>Serial Number</th>
                </tr>
            </thead> 
            <tbody>
                {% for device in device_list %}
                <tr>
                    <td> {{ device.0 }} </td>
                    <td> {{ device.1 }} </td>
                    <td> {{ device.2 }} </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="container pt-4">
        <h1>Key search with encrypted PCAP and memory dump.</h1> 
        <p>As this tool is for educational purposes, we Hackbee provides a memory dump and encrypted PCAP with ZigBee traffic.</p>
        <p>If you have a memory dump and encrypted PCAP, provide the path using the options:</p>
        <ol>
            <li>-r : path to encrypted packet capture file.</li>
            <li>-f : path to memory dump.</li>
        </ol>
        <form method="POST">
            {% csrf_token %}
            <input type="text" name="input_pcap" value="Path to encrypted PCAP. Default path is in ressources folder of hackbee.">
            <input type="text" name="input_memdump" value="Path to memory dump. Default path is in ressources folder of hackbee.">
            <input type="submit" name="start_zbgoodfind" value="Start key search.">
        </form>
        <table class="table table-sm">
            <thead>
                <tr>
                    <th>Status</th>
                    <th>Guesses</th>
                    <th>Key</th>
                </tr>
            </thead> 
            <tbody>
                <tr>
                    <td> {{ goodfind_results['key'] }} </td>
                    <td> {{ goodfind_results['guesses'] }} </td>
                    <td> {{ goodfind_results['status'] }} </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}

    
            